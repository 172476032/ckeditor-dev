<head>
	<style>
		body {
			padding-top: 120px !important;
		}
	</style>
</head>
<textarea id="editor">
	<p>Hello world</p>
	<ol>
		<li>One</li>
		<li>Two</li>
		<li>Three</li>
	</ol>
</textarea>
<button onclick="toggleConfirm( this );">Turn on confirmation.</button>
<script>
	CKEDITOR.plugins.add( 'test', {
		init: function( editor ) {
			editor.addCommand( 'testCommand', {
				exec: function( editor ) {
					editor.balloonToolbars._contexts[ 0 ].openDialog( 'testDialog' );
				}
				} );

			if ( editor.ui.addButton ) {
				editor.ui.addButton( 'testButton', {
					label: 'Test Label',
					command: 'testCommand'
				} );
			}

			CKEDITOR.dialog.add( 'testDialog', function( editor ) {
				var dialogDefinition = {
					title: 'Test dialog',
					contents: [
						{
							id: 'tab1',
							label: 'Test Label',
							title: 'Test Title',
							elements: [
								{
									type: 'html',
									html: '<p>Hello World</p>'
								}
							]
						},
						{
							id: 'tab2',
							label: 'Test Label 2',
							title: 'Test Title 2',
							elements: [
								{
									type: 'vbox',
									align: 'right',
									width: '200px',
									children: [
										{
											type: 'text',
											id: 'age',
											label: 'Age'
										},
										{
											type: 'text',
											id: 'sex',
											label: 'Sex'
										},
										{
											type: 'text',
											id: 'nationality',
											label: 'Nationality'
										}
									]
								}
							]
						}
					],
					onOk: function() {
						console.log( 'OK OK OK!!!' );
					},
					buttons: [
						CKEDITOR.dialog.okButton,
						CKEDITOR.dialog.cancelButton
					],
					height: 200
				}

				return dialogDefinition;
			} );

		}
	} )

	CKEDITOR.plugins.add( 'test2', {
			init: function( editor ) {
				editor.addCommand( 'testCommand2', {
					exec: function( editor ) {
						editor.balloonToolbars._contexts[ 0 ].openDialog( 'testDialog2' );
					}
				 } );

				if ( editor.ui.addButton ) {
					editor.ui.addButton( 'testButton2', {
						label: 'Test Label2',
						command: 'testCommand2'
					} );
				}

				CKEDITOR.dialog.add( 'testDialog2', '%BASE_PATH%/plugins/balloontoolbar/manual/integration/dialog/_assets/testDialog2.js' );

			}
		} )


	var editor = CKEDITOR.replace( 'editor', {
		extraPlugins: 'balloontoolbar,test,test2',
		balloontoolbarIgnoreConfirm: true
	} );
	editor.on( 'instanceReady', function( evt ) {
		var editor = evt.editor;
		editor.balloonToolbars.create( {
			buttons: 'testButton,testButton2',
			cssSelector: 'li'
		} );
	} );

	function toggleConfirm( btn ) {
		editor.config.balloontoolbarIgnoreConfirm = !editor.config.balloontoolbarIgnoreConfirm;
		if ( editor.config.balloontoolbarIgnoreConfirm ) {
			btn.innerText = 'Turn on confirmation.';
		} else {
			btn.innerText = 'Turn off confirmation.';
		}
	}
</script>
